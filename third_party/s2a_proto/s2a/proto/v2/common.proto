syntax = "editions";

package s2a.proto.v2;

import "third_party/golang/protobuf/v2/src/google/protobuf/go_features.proto";

option java_multiple_files = true;
option java_outer_classname = "CommonProto";
option java_package = "com.google.s2a.proto.v2";

message L7lbId {
    optional uint64 project_number = 1;
    optional fixed64 backend_service_incarnation_id = 2;
}

message Identity {
    map<string, string> attributes = 3;
    
    oneof identity_oneof {
        string spiffe_id = 1;
        string hostname = 2;
        string uid = 4;
        string username = 5;
        string gcp_id = 6;
        L7lbId l7lb_id = 7;
    }
}

enum Ciphersuite {
    CIPHERSUITE_UNSPECIFIED = 0;
    CIPHERSUITE_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 = 1;
    CIPHERSUITE_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 = 2;
    CIPHERSUITE_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 = 3;
    CIPHERSUITE_ECDHE_RSA_WITH_AES_128_GCM_SHA256 = 4;
    CIPHERSUITE_ECDHE_RSA_WITH_AES_256_GCM_SHA384 = 5;
    CIPHERSUITE_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 = 6;
    CIPHERSUITE_ECDHE_ECDSA_WITH_AES_128_CBC_SHA = 7;
    CIPHERSUITE_ECDHE_RSA_WITH_AES_128_CBC_SHA = 8;
    CIPHERSUITE_ECDHE_ECDSA_WITH_AES_256_CBC_SHA = 9;
    CIPHERSUITE_ECDHE_RSA_WITH_AES_256_CBC_SHA = 10;
    CIPHERSUITE_RSA_WITH_AES_128_GCM_SHA256 = 11;
    CIPHERSUITE_RSA_WITH_AES_256_GCM_SHA384 = 12;
    CIPHERSUITE_RSA_WITH_AES_128_CBC_SHA = 13;
    CIPHERSUITE_RSA_WITH_AES_256_CBC_SHA = 14;
    CIPHERSUITE_RSA_WITH_3DES_EDE_CBC_SHA = 15;
}

enum TLSVersion {
    TLS_VERSION_UNSPECIFIED = 0;
    TLS_VERSION_1_0 = 1;
    TLS_VERSION_1_1 = 2;
    TLS_VERSION_1_2 = 3;
    TLS_VERSION_1_3 = 4;
}

enum ConnectionSide {
    CONNECTION_SIDE_UNSPECIFIED = 0;
    CONNECTION_SIDE_CLIENT = 1;
    CONNECTION_SIDE_SERVER = 2;
}

enum AlpnProtocol {
    ALPN_PROTOCOL_UNSPECIFIED = 0;
    ALPN_PROTOCOL_GRPC = 1;
    ALPN_PROTOCOL_HTTP2 = 2;
    ALPN_PROTOCOL_HTTP1_1 = 3;
}
