syntax = "editions";

package rpc;

import "net/proto2/bridge/proto/message_set.proto";

option java_package = "com.google.net.rpc.proto";

message PerfRequest {
    optional TYPE type = 1 [default = BY_METHOD];
    enum TYPE {
        BY_METHOD = 0;
        BY_SERVER = 1;
        BY_CLIENT = 2;
        BACKENDS = 3;
    }
}

message PerfResponseErrorCount {
    optional int32 status = 1;
    optional int64 count = 2;
}

message PerfResponseStats {
    optional int64 count = 2;
    optional int32 latency = 3;
    optional int32 max_latency = 4;
    optional float rate = 5;
    optional float arg_bytes_rate = 6;
    optional float result_bytes_rate = 7;
    optional float uncompressed_result_bytes_rate = 8;
    optional int64 rpc_errors = 9;
    optional int64 app_errors = 10;
    optional float server_elapsed_deprecated = 11;
    optional int64 retransmissions = 12;
    optional int64 duplicates = 13;
    optional int64 latency_sum_msec = 14;
    optional int64 server_latency_sum_msec = 15;
    optional int64 interval_msec = 16;
    optional int64 request_bytes_sum = 17;
    optional int64 response_bytes_sum = 18;
    optional int64 uncompressed_response_bytes_sum = 19;
    repeated PerfResponseErrorCount error_count = 20;
    optional int64 uncompressed_request_bytes_sum = 21;
    optional float uncompressed_arg_bytes_rate = 22;
    optional int64 count_ipv4 = 23;
    optional int64 count_ipv6 = 24;
    optional int64 count_other = 25;
    optional int64 local_stall_time_sum_msec = 26;
}

message PerfResponseGroupRow {
    optional string name = 1;
    optional PerfResponseStats minute = 2;
    optional PerfResponseStats hour = 3;
    optional PerfResponseStats total = 4;
}

message PerfResponseGroup {
    optional string name = 1;
    optional PerfResponseGroupRow total = 2;
    repeated PerfResponseGroupRow row = 3;
}

message PerfResponseCategory {
    optional string name = 1;
    repeated PerfResponseGroup group = 2;
}

message PerfResponse {
    repeated PerfResponseCategory category = 1;
    
    extend .proto2.bridge.MessageSet {
        optional PerfResponse message_set_extension = 7620611;
    }
}
