syntax = "editions";

package cloud_identity;

import "google/api/inclusion.proto";
import "storage/datapol/annotations/proto/semantic_annotations.proto";

option java_multiple_files = true;
option java_package = "com.google.cloud.identity.gluon.proto";

message SubordinateCertificate {
    optional string root_identifier = 1;
    optional SignedMessage signed_authority = 2;
    optional string keyset_name = 3;
}

message SignedMessage {
    optional bytes prefix = 1;
    optional bytes serialized_message = 2;
    optional bytes signature = 3;
}

enum CmscValidationResult {
    CMSC_VALIDATION_RESULT_UNSPECIFIED = 0;
    CMSC_VALIDATION_RESULT_VALID = 1;
    CMSC_VALIDATION_RESULT_SIGNATURE_INVALID = 2;
    CMSC_VALIDATION_RESULT_WIRE_INVALID = 3;
    CMSC_VALIDATION_RESULT_INTERNAL_ERROR = 4;
    CMSC_VALIDATION_RESULT_KEY_MATERIAL_UNAVAILABLE = 5;
    CMSC_VALIDATION_RESULT_EXPIRED = 6;
    CMSC_VALIDATION_RESULT_INVALID_CMSC_PAYLOAD = 7;
    CMSC_VALIDATION_RESULT_MINT_VERIFICATION_FAILED = 8;
}
