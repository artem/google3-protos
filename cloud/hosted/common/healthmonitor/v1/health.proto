syntax = "proto3";

package cloud.hosted.common.healthmonitor.v1;

import "google/protobuf/any.proto";

option java_multiple_files = true;
option java_outer_classname = "HealthProto";
option java_package = "com.google.cloud.common.healthmonitor.v1";

message Health {
    ResourceId resource_id = 1;
    repeated HealthMetric health_metrics = 2;
    HealthStatus status = 3;
    int64 last_accepted_sequence = 4;
    repeated ConfigState config_states = 5;
}

message HealthMetric {
    string scope = 1;
    string name = 2;
    HealthStatus status = 3;
    google.protobuf.Any details = 4;
    AggregationTarget aggregation_target = 5;
}

message ResourceId {
    string id = 1;
    string type = 2;
    string root_id = 3;
}

message ConfigState {
    string name = 1;
    
    oneof state {
        ConfigComplete complete = 10;
        ConfigInProgress in_progress = 11;
    }
}

message ConfigComplete {
    int64 config_version = 1;
    google.protobuf.Any data = 2;
}

message ConfigInProgress {
    int64 accepted_version = 1;
    int64 applied_version = 2;
    google.protobuf.Any change_progress = 3;
}

enum AggregationTarget {
    TARGET_UNSPECIFIED = 0;
    TARGET_ALL = 1;
    TARGET_SCOPE = 2;
    TARGET_NONE = 3;
}

enum HealthStatus {
    UNKNOWN = 0;
    HEALTHY = 1;
    UNHEALTHY = 2;
    UNRESPONSIVE = 3;
}
