syntax = "editions";

package storage_l4;

import "storage/datapol/annotations/proto/semantic_annotations.proto";
import "storage/k3/net/socket_address.proto";

message StringKeyProto {
    optional bytes key = 1;
    optional string owner = 3;
    
    reserved 2;
}

message DFileKeyProto {
    optional string colossus_cell = 6;
    optional int64 volume_id = 7;
    optional uint64 chunk_id = 8;
    optional bool colossus_cell_is_cfs2 = 10;
    optional bool is_timelock = 13;
    optional string d_server_location = 11;
    optional int64 value_offset = 2;
    optional int64 nominal_value_length = 3;
    optional int64 cfs_file_id = 4;
    optional int64 colossus_stripe_index = 5;
    optional string colossus_filename = 9;
    optional int64 cfs_base_file_id = 14;
    
    reserved 1, 12;
}

message ColossusStripeKeyProto {
    optional string cfs_cell = 1;
    optional bool is_cfs2 = 2;
    optional int64 cfs_file_id = 3;
    optional int64 stripe_index = 4;
    optional int64 value_offset = 5;
    optional int64 nominal_value_length = 6;
    optional string owner = 7;
    optional int64 cfs_base_file_id = 8;
    optional string filename = 9;
    
    repeated ChunkId chunks = 10;
    message ChunkId {
        optional int32 chunk_index = 1;
        optional int64 volume_id = 2;
        optional uint64 chunk_handle = 3;
        optional .k3.SocketAddressProto d_server_address = 4;
    }
}

message KeyProto {
    oneof key_type {
        StringKeyProto string = 1;
        DFileKeyProto d_file = 5;
        ColossusStripeKeyProto colossus_stripe = 7;
    }
    
    reserved 2, 3, 4, 6;
}
