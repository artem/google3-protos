syntax = "proto2";

package speckle;

import "storage/datapol/annotations/proto/semantic_annotations.proto";

message SslCert {
    optional string cert = 1;
    optional string name = 2;
    optional int64 validity_not_before_ms = 3;
    optional int64 validity_not_after_ms = 4;
    optional string sha1_fingerprint = 5;
    optional int64 create_time_ms = 6;
    optional string serial_number = 7;
    optional string encryption_algorithm = 8;
    optional string ca_resource_name = 9;
}

message SslCaClientCertProto {
    optional SslCert ca_cert_info = 1;
    optional string name = 2;
    optional string client_sha1_fingerprint = 3;
    optional SslCert client_cert_info = 4;
}

message SslParamsProto {
    repeated SslCert ca_server = 1;
    repeated bytes ca_server_pkey = 21;
    repeated SslCert server_cert = 2;
    repeated bytes server_pkey = 3;
    repeated SslCaClientCertProto ca_client = 4;
    optional SslCert signing_ca = 7;
    optional bytes signing_ca_pkey = 8;
    optional SslCert sfe_client_cert = 9;
    optional bytes sfe_client_pkey = 10;
    optional SslCert replica_ca = 11;
    optional SslCert replica_cert = 12;
    optional bytes replica_pkey = 13;
    optional SslCert master_server_ca_slave_copy = 14;
    optional SslCert replica_cert_slave_copy = 15;
    optional bytes replica_pkey_slave_copy = 16;
    optional SslCert deleted_19 = 19 [deprecated = true];
    optional bytes deleted_20 = 20 [deprecated = true];
    optional bool force_require_x509 = 5 [default = false];
    
    optional SslMode ssl_mode = 22;
    enum SslMode {
        SSL_MODE_UNSPECIFIED = 0;
        ALLOW_UNENCRYPTED_AND_ENCRYPTED = 1;
        ENCRYPTED_ONLY = 2;
        TRUSTED_CLIENT_CERTIFICATE_REQUIRED = 3;
    }
    
    optional CaMode server_ca_mode = 23;
    enum CaMode {
        CA_MODE_UNSPECIFIED = 0;
        GOOGLE_MANAGED_INTERNAL_CA = 1;
        GOOGLE_MANAGED_CAS_CA = 2;
        CUSTOMER_MANAGED_CAS_CA = 3;
    }
    
    optional string server_ca_pool = 24;
    optional bytes encrypted_server_ca_pool = 25;
    optional string min_tls_version = 26;
    optional string max_tls_version = 27;
    
    reserved 6, 17, 18;
}
