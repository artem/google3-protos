syntax = "editions";

package postgres.extensions.postgres_ann;

import "storage/datapol/annotations/proto/semantic_annotations.proto";

message KMeansPartitioningConfig {
    optional int32 num_children = 1 [default = 2];
    optional int32 max_num_levels = 2 [default = 1];
    optional int32 min_cluster_size = 3 [default = 1];
    optional int32 max_cluster_size = 4;
    optional int32 max_clustering_iterations = 5 [default = 12];
    optional bool spilling = 6 [default = true];
    optional int64 expected_sample_size = 7;
    optional bool spherical = 8;
    optional bool random_init_centers = 9 [default = true];
    optional int32 num_threads = 10 [default = 1];
    optional int32 num_leaves = 11 [default = 2];
    optional string distance_measure = 12;
    optional bool use_pca = 13 [default = false];
    optional int32 num_tokenized_branch = 15 [default = 1];
    optional bool enable_avq = 16 [default = true];
    optional double avq_eta_value = 17 [default = 2.5];
    
    optional LeafQuantization leaf_quantization = 18 [default = FIXED_POINT_INT8];
    enum LeafQuantization {
        UNSPECIFIED = 0;
        FIXED_POINT_INT8 = 1;
        FLOAT = 2;
        ASYMMETRIC_HASHING = 3;
    }
    
    optional double noise_shaping_threshold = 21 [default = nan];
    optional float orthogonality_amplification_lambda = 22 [default = 1.5];
    optional bool enable_declarative_recall = 23 [default = false];
    optional int32 pca_min_dimensionality = 24 [default = 500];
    optional string index_build_artifact_dir = 25;
    
    reserved 14, 19, 20;
}
