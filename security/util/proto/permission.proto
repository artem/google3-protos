syntax = "proto2";

import "net/proto2/bridge/proto/message_set.proto";
import "security/credentials/proto/principal.proto";
import "security/rpc_restrictions/proto/rpc_permissions.proto";
import "security/thinmint/proto/thinmint.proto";
import "storage/datapol/annotations/proto/semantic_annotations.proto";

option java_package = "com.google.security.util.genfiles";

message AcctRestrictions {
    optional DestinationRestriction destination_restriction = 3 [lazy = true];
    
    reserved 1, 2;
    
    reserved "dst_restrictions", "src_restriction";
    
    extend .proto2.bridge.MessageSet {
        optional AcctRestrictions message_set_extension = 43674265;
    }
}

message DestinationRestriction {
    repeated DestinationPermission destination_permissions = 1;
    repeated security_rpc_restrictions.Permission permissions = 3;
    optional string context_url = 2;
}

message DestinationPermission {
    optional DestinationType type = 1;
    enum DestinationType {
        CORP = 2;
        PROD = 4;
    }
    
    repeated string security_tags = 8;
    repeated string security_realms = 7;
    optional security.credentials.PrincipalProto principal = 2;
    optional string job = 3;
    repeated .thinmint.ThinMintDescription rpc_services_labels = 4;
    repeated .thinmint.ThinMintDescription application_thinmint_descriptions = 5 [deprecated = true];
    optional string description = 6;
    optional bool report_usage = 9;
}
