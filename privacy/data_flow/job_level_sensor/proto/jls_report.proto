syntax = "editions";

package privacy.data_flow.job_level_sensor.proto;

import "google/protobuf/any.proto";

option java_multiple_files = true;

message JlsRecord {
    optional google.protobuf.Any data = 1;
    
    optional TargetedJoinKey targeted_join_key = 2;
    message TargetedJoinKey {
        optional fixed64 destination_guri_fingerprint = 1;
    }
    
    extensions 100 to 1000;
}

message JlsReport {
    repeated JlsRecord static_data = 1;
    map<fixed64, DynamicRecordMetadata> dynamic_data = 3;
    
    oneof execution_id {
        int64 borg_run_uid = 6;
        int64 custom_execution_id = 7;
    }
    
    reserved 2, 4, 5;
    
    message FlowTransition {
        optional fixed64 old_flow_id = 1;
        optional fixed64 new_flow_id = 2;
        repeated fixed64 pcids = 3 [deprecated = true];
    }
    
    message DynamicRecordMetadata {
        optional JlsRecord record = 1;
        repeated fixed64 ids = 2 [deprecated = true];
        repeated FlowTransition flow_transitions = 3;
    }
}
