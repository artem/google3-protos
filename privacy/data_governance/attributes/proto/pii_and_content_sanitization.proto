syntax = "proto3";

package privacy.data_governance.attributes;

import "google/api/inclusion.proto";
import "google/protobuf/timestamp.proto";
import "privacy/data_governance/attributes/proto/classification.proto";

option java_multiple_files = true;
option java_package = "com.google.privacy.datagovernance.attributes";

message SanitizationProcess {
    oneof process {
        Syft syft = 1;
        BardHumanReview bard_human_review = 2;
    }
    
    message Syft {
        oneof _inspect_template_id {
            int32 inspect_template_id = 5;
        }
        
        oneof _deidentify_template_id {
            int32 deidentify_template_id = 6;
        }
        
        oneof _detection_timestamp {
            google.protobuf.Timestamp detection_timestamp = 3;
        }
        
        oneof _transformation_timestamp {
            google.protobuf.Timestamp transformation_timestamp = 4;
        }
        
        oneof _inspect_template_path {
            string inspect_template_path = 1 [deprecated = true];
        }
        
        oneof _deidentify_template_path {
            string deidentify_template_path = 2 [deprecated = true];
        }
    }
    
    message BardHumanReview {
        bool reviewed_with_bard_pii_procedure = 1;
        
        oneof _review_timestamp {
            google.protobuf.Timestamp review_timestamp = 2;
        }
    }
}

message PiiAndContentSanitization {
    repeated SanitizationProcess sanitization = 1;
}
